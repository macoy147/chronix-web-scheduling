<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#002D62">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>CHRONIX - Authentication</title>
    <link rel="icon" type="image/png" href="/img/img/CHRONIX_LOGO.png">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="/css/auth.css">
</head>
<body>

<!-- Return to Home Button -->
<a href="index.html" class="home-button" id="homeButton">
    <i class="fas fa-home"></i>
    <span>Home</span>
</a>

<!-- Nested divs for CSS target selectors -->
<div class="ct" id="t1">
<div class="ct" id="t2">

<!-- Navigation Menu -->
<ul id="menu">
    <a href="#t1">
        <li class="icon" id="signin-nav">
            <i class="fas fa-sign-in-alt"></i>
            <span class="icon-label">Sign In</span>
        </li>
    </a>
    <a href="#t2">
        <li class="icon" id="signup-nav">
            <i class="fas fa-user-plus"></i>
            <span class="icon-label">Sign Up</span>
        </li>
    </a>
</ul>

<!-- Page 1: Sign In -->
<div class="page" id="p1">
    <section class="page-content">
        <div class="auth-logos-container">
            <img src="/img/img/CTU_new_logo-removebg-preview.png" alt="CTU Logo" class="auth-logo">
            <img src="/img/img/CHRONIX_LOGO.png" alt="Chronix Logo" class="auth-logo chronix-logo">
        </div>
        <h1 class="page-title">Welcome Back</h1>
        <p class="page-subtitle">Sign in to access your schedule</p>
        
        <form id="loginForm" class="auth-form">
            <div class="input-group">
                <i class="fas fa-envelope"></i>
                <input type="email" name="email" placeholder="Email Address" required />
            </div>
            
            <div class="input-group password-wrapper">
                <i class="fas fa-lock"></i>
                <input type="password" name="password" placeholder="Password" id="loginPassword" required />
                <span class="toggle-password" data-target="loginPassword">
                    <i class="fas fa-eye-slash"></i>
                </span>
            </div>
            
            <a href="#" class="forgot-link">Forgot your password?</a>
            
            <button type="submit" class="auth-button">
                <span>Sign In</span>
                <i class="fas fa-arrow-right"></i>
            </button>
            
            <p class="switch-text">
                Don't have an account? <a href="#t2" class="switch-link">Sign Up</a>
            </p>
        </form>
    </section>
</div>

<!-- Page 2: Sign Up -->
<div class="page" id="p2">
    <section class="page-content">
        <div class="auth-logos-container">
            <img src="/img/img/CTU_new_logo-removebg-preview.png" alt="CTU Logo" class="auth-logo">
            <img src="/img/img/CHRONIX_LOGO.png" alt="Chronix Logo" class="auth-logo chronix-logo">
        </div>
        <h1 class="page-title">Create Account</h1>
        <p class="page-subtitle">Join CHRONIX scheduling system</p>
        
        <form id="registerForm" class="auth-form" autocomplete="off">
            <div class="input-group">
                <i class="fas fa-user"></i>
                <input type="text" name="fullname" placeholder="Full Name" required />
            </div>
            
            <div class="input-group">
                <i class="fas fa-envelope"></i>
                <input type="email" name="email" placeholder="Email Address" required />
            </div>
            
            <div class="row-two-fields">
                <div class="input-group">
                    <i class="fas fa-venus-mars"></i>
                    <select name="gender" required>
                        <option value="" disabled selected>Gender</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <i class="fas fa-calendar"></i>
                    <input type="date" name="birthdate" placeholder="Birthdate" required />
                </div>
            </div>
            
            <div class="row-two-fields">
                <div class="input-group">
                    <i class="fas fa-user-tag"></i>
                    <select name="userrole" id="userRoleSelect" required>
                        <option value="" disabled selected>User Role</option>
                        <option value="student">Student</option>
                        <option value="teacher">Teacher</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <i class="fas fa-id-card"></i>
                    <input type="text" name="ctuid" placeholder="Student/Faculty ID" required />
                </div>
            </div>
            
            <div class="input-group">
                <i class="fas fa-users"></i>
                <select name="section" id="sectionSelect" required>
                    <option value="" disabled selected>Select Section</option>
                </select>
            </div>
            
            <div class="input-group password-wrapper">
                <i class="fas fa-lock"></i>
                <input type="password" name="password" placeholder="Password" id="signupPassword" required />
                <span class="toggle-password" data-target="signupPassword">
                    <i class="fas fa-eye-slash"></i>
                </span>
            </div>
            
            <div class="input-group password-wrapper">
                <i class="fas fa-lock"></i>
                <input type="password" name="confirmpassword" placeholder="Confirm Password" id="signupConfirmPassword" required />
                <span class="toggle-password" data-target="signupConfirmPassword">
                    <i class="fas fa-eye-slash"></i>
                </span>
            </div>
            
            <button type="submit" class="auth-button">
                <span>Create Account</span>
                <i class="fas fa-arrow-right"></i>
            </button>
            
            <p class="switch-text">
                Already have an account? <a href="#t1" class="switch-link">Sign In</a>
            </p>
        </form>
    </section>
</div>

</div>
</div>

<script type="module" src="/js/api-config.js"></script>
<script type="module" src="/js/auth.js"></script>

<!-- Mobile detection and redirection -->
<script>
// Mobile detection and redirection
function isMobileDevice() {
    return window.innerWidth <= 768 || 
           /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
}

// Prevent redirect loops
let lastRedirectTime = 0;
const REDIRECT_COOLDOWN = 1000;

function shouldRedirectToMobile() {
    const now = Date.now();
    if (now - lastRedirectTime < REDIRECT_COOLDOWN) {
        return false;
    }
    
    return isMobileDevice() && !window.location.pathname.includes('-mobile');
}

function shouldRedirectToDesktop() {
    const now = Date.now();
    if (now - lastRedirectTime < REDIRECT_COOLDOWN) {
        return false;
    }
    
    return window.innerWidth > 768 && window.location.pathname.includes('-mobile');
}

// Initial redirect check
if (shouldRedirectToMobile()) {
    lastRedirectTime = Date.now();
    console.log('Redirecting to mobile version...');
    window.location.href = '/auth-mobile.html';
}

// Handle resize events
let resizeTimeout;
window.addEventListener('resize', function() {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(function() {
        if (shouldRedirectToMobile()) {
            lastRedirectTime = Date.now();
            console.log('Screen resized - redirecting to mobile version...');
            window.location.href = '/auth-mobile.html';
        } else if (shouldRedirectToDesktop()) {
            lastRedirectTime = Date.now();
            console.log('Screen resized - redirecting to desktop version...');
            window.location.href = '/auth.html';
        }
    }, 250);
});
</script>

</body>
</html>
